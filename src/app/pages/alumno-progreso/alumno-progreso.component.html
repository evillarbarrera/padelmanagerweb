<div class="admin-layout">
    <app-sidebar [userId]="userId" [jugadorNombre]="coachNombre" [role]="'entrenador'" activePage="alumnos">
    </app-sidebar>

    <main class="main-content">
        <header class="top-header">
            <div class="breadcrumbs">
                <span>Panel de Entrenador</span>
                <span class="separator">/</span>
                <span class="clickable" (click)="volver()">Mis Alumnos</span>
                <span class="separator">/</span>
                <span class="current">Progreso de {{ alumnoNombre }}</span>
            </div>

            <div class="actions">
                <button class="back-btn" (click)="volver()">
                    ‚Üê Volver
                </button>
            </div>
        </header>

        <div class="dashboard-grid fade-in">

            <!-- Student Header -->
            <div class="student-header-card">
                <div class="student-info">
                    <div class="avatar-large">
                        <img [src]="alumnoFoto || 'assets/images/placeholder_avatar.png'" style="object-fit: cover;" />
                    </div>
                    <div>
                        <h1>{{ alumnoNombre }}</h1>
                        <p>An√°lisis de Rendimiento y Evoluci√≥n</p>
                    </div>
                </div>
            </div>

            <!-- Charts Grid -->
            <div class="charts-container" *ngIf="!isLoading && hasData">

                <!-- Radar Chart -->
                <div class="chart-card">
                    <div class="card-header">
                        <h3>Mapa de Habilidades</h3>
                        <p>Distribuci√≥n t√©cnica actual</p>
                    </div>
                    <div class="canvas-wrapper">
                        <canvas id="webRadarChart"></canvas>
                    </div>
                </div>

                <!-- Line Chart -->
                <div class="chart-card">
                    <div class="card-header">
                        <h3>Evoluci√≥n General</h3>
                        <p>Progreso sesi√≥n a sesi√≥n</p>
                    </div>
                    <div class="canvas-wrapper">
                        <canvas id="webLineChart"></canvas>
                    </div>
                </div>

            </div>

            <!-- Loading State -->
            <div *ngIf="isLoading" class="loading-state">
                <div class="spinner"></div>
                <p>Cargando datos del alumno...</p>
            </div>

            <!-- Empty State -->
            <div *ngIf="!isLoading && !hasData" class="empty-state">
                <div class="empty-icon">üìä</div>
                <h3>Sin datos de evaluaci√≥n</h3>
                <p>Este alumno a√∫n no ha sido evaluado.</p>
                <button class="create-eval-btn" (click)="volver()">Volver a Alumnos</button>
            </div>

            <!-- Training Videos Section -->
            <div class="videos-section" *ngIf="!isLoading">
                <div class="section-header">
                    <h2>üé• Videos de Entrenamiento</h2>
                    <p>Revisiones t√©cnicas y jugadas destacadas</p>
                </div>

                <div class="videos-grid" *ngIf="videos.length > 0; else noVideos">
                    <div class="video-card" *ngFor="let vid of videos">
                        <div class="video-wrapper">
                            <video [src]="vid.video_url" controls preload="metadata" playsinline></video>
                        </div>
                        <div class="video-info">
                            <div class="vid-header-row">
                                <h4>{{ vid.titulo || 'Sin t√≠tulo' }}</h4>
                                <button class="delete-vid-btn" (click)="confirmDeleteVideo(vid)">
                                    üóëÔ∏è
                                </button>
                            </div>
                            <p class="date">{{ vid.fecha | date:'dd/MM/yyyy HH:mm' }}</p>
                            <p class="comment" *ngIf="vid.comentario">{{ vid.comentario }}</p>
                        </div>
                    </div>
                </div>

                <ng-template #noVideos>
                    <div class="empty-videos">
                        <p>No se han subido videos de entrenamiento para este alumno.</p>
                    </div>
                </ng-template>
            </div>

        </div>
    </main>
</div>