<div class="admin-layout">
    <!-- Sidebar -->
    <app-sidebar [userId]="userId" [jugadorNombre]="userName" [jugadorFoto]="userFoto" [role]="userRole"
        activePage="club-admin">
    </app-sidebar>

    <!-- Main Content Area -->
    <main class="main-content">
        <!-- Top Header -->
        <header class="top-header">
            <div class="breadcrumbs">
                <span>Administraci√≥n</span>
                <span class="separator">/</span>
                <span class="current">Gesti√≥n de Club</span>
            </div>

            <div class="user-profile frc">
                <div class="user-info">
                    <span class="name">{{ userName }}</span>
                    <span class="role">Admin Club</span>
                </div>
                <img class="avatar-circle" [src]="userFoto || 'assets/images/placeholder_avatar.png'"
                    style="object-fit: cover;">
            </div>
        </header>

        <!-- Dashboard Content -->
        <div class="dashboard-container">
            <div class="main-grid">
                <!-- SECCI√ìN CLUBES -->
                <div class="card glass-card">
                    <!-- Tab Navigation -->
                    <div class="main-tabs-nav" style="margin-bottom: 20px;">
                        <button class="tab-btn" [class.active]="activeTab === 'list'" (click)="activeTab = 'list'">
                            <span class="icon">üè¢</span> Mis Clubes
                        </button>
                        <button class="tab-btn" [class.active]="activeTab === 'create'" (click)="activeTab = 'create'">
                            <span class="icon">‚ûï</span> Crear Nuevo Club
                        </button>
                    </div>

                    <!-- VISTA LISTA -->
                    <div *ngIf="activeTab === 'list'">
                        <div class="club-list">
                            <div *ngFor="let club of clubes" class="item-card clickable"
                                [class.active]="selectedClub?.id === club.id" (click)="selectClub(club)">
                                <div class="item-info">
                                    <h3>{{ club.nombre }}</h3>
                                    <p><span class="label-icon">üìç</span>{{ club.direccion }}</p>
                                    <p style="font-size: 11px; margin-top: 5px;" *ngIf="club.region">
                                        {{ club.region }} - {{ club.comuna }}
                                    </p>
                                </div>
                                <div class="item-actions">
                                    <span class="status-badge">Activo</span>
                                    <div class="frc" style="gap: 8px;">
                                        <button class="btn-icon" (click)="editClub(club, $event)" title="Editar Club">
                                            ‚úèÔ∏è
                                        </button>
                                        <button class="btn-delete-mini" (click)="deleteClub(club, $event)"
                                            title="Borrar Club">
                                            üóëÔ∏è
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Add new club shortcut card -->
                            <div class="item-card add-card clickable" (click)="activeTab = 'create'">
                                <div class="add-content">
                                    <span class="plus-icon">‚ûï</span>
                                    <span>Agregar Club</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- VISTA CREAR / EDITAR -->
                    <div *ngIf="activeTab === 'create'" class="create-view animate-in">
                        <div class="form-section" style="border-top: none; margin-top: 0; padding-top: 0;">
                            <h3>{{ editingClubId ? 'Editar Club' : 'Registrar un Nuevo Club' }}</h3>
                            <div class="input-group">
                                <label>Nombre del Club</label>
                                <input type="text" [(ngModel)]="newClub.nombre" placeholder="Ej: Padel Center">

                                <label>Regi√≥n</label>
                                <select [(ngModel)]="newClub.region" (change)="updateComunas()">
                                    <option value="" disabled selected>Selecciona regi√≥n</option>
                                    <option *ngFor="let r of regions" [value]="r.name">{{ r.name }}</option>
                                </select>

                                <label>Comuna</label>
                                <select [(ngModel)]="newClub.comuna" [disabled]="!newClub.region">
                                    <option value="" disabled selected>Selecciona comuna</option>
                                    <option *ngFor="let c of filteredComunas" [value]="c">{{ c }}</option>
                                </select>

                                <label>Calle / Direcci√≥n</label>
                                <input type="text" [(ngModel)]="newClub.direccion" placeholder="Ej: Av. Principal 123">

                                <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <div class="input-item">
                                        <label>Tel√©fono (Opcional)</label>
                                        <input type="text" [(ngModel)]="newClub.telefono" placeholder="+56 9 ...">
                                    </div>
                                    <div class="input-item">
                                        <label>Instagram (Opcional)</label>
                                        <input type="text" [(ngModel)]="newClub.instagram" placeholder="@club_padel">
                                    </div>
                                </div>

                                <label>Email de Contacto (Opcional)</label>
                                <input type="email" [(ngModel)]="newClub.email" placeholder="contacto@club.com">

                                <div class="actions-row" style="margin-top: 20px;">
                                    <button class="btn-primary" (click)="createClub()">
                                        {{ editingClubId ? 'Actualizar Club' : 'Guardar Club' }}
                                    </button>
                                    <button class="btn-cancel" (click)="cancelEditClub()">Cancelar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECCI√ìN CANCHAS -->
                <div class="card glass-card" *ngIf="selectedClub">
                    <div class="card-header">
                        <span class="icon">üéæ</span>
                        <h2>Canchas en {{ selectedClub.nombre }}</h2>
                    </div>

                    <div class="cancha-list grid-list">
                        <div *ngFor="let cancha of canchas" class="item-card cancha-item"
                            [class.editing-card]="editingCanchaId === cancha.id">
                            <div class="cancha-top">
                                <span class="cancha-type">{{ cancha.tipo }}</span>
                                <div class="cancha-actions">
                                    <button class="btn-icon" (click)="editCancha(cancha)" title="Editar">‚úèÔ∏è</button>
                                    <button class="btn-icon delete" (click)="deleteCancha(cancha)"
                                        title="Eliminar">üóëÔ∏è</button>
                                </div>
                                <h3>{{ cancha.nombre }}</h3>
                            </div>
                            <div class="cancha-body">
                                <p>Superficie: <strong>{{ cancha.superficie }}</strong></p>
                                <div class="price-tag">
                                    <span class="currency">$</span>
                                    <span class="amount">{{ cancha.precio_hora }}</span>
                                    <span class="per">/hora</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-section cancha-form-section">
                        <h3>
                            <span class="icon">{{ editingCanchaId ? '‚úèÔ∏è' : 'üèüÔ∏è' }}</span>
                            {{ editingCanchaId ? 'Editar Cancha' : 'Agregar Cancha' }}
                        </h3>
                        <div class="form-grid">
                            <input type="text" [(ngModel)]="newCancha.nombre"
                                placeholder="Nombre de Cancha (Ej: Pista 1)">
                            <select [(ngModel)]="newCancha.tipo">
                                <option value="Outdoor">Outdoor</option>
                                <option value="Indoor">Indoor</option>
                                <option value="Cubierta">Cubierta</option>
                            </select>
                            <select [(ngModel)]="newCancha.superficie">
                                <option value="C√©sped Sint√©tico">C√©sped Sint√©tico</option>
                                <option value="Cemento">Cemento</option>
                                <option value="Arcilla">Arcilla</option>
                            </select>
                            <input type="number" [(ngModel)]="newCancha.precio_hora" placeholder="Precio x Hora">

                            <button class="btn-secondary" [class.btn-update]="editingCanchaId" (click)="saveCancha()">
                                {{ editingCanchaId ? 'Actualizar Cancha' : 'Vincular Cancha' }}
                            </button>
                            <button *ngIf="editingCanchaId" class="btn-cancel"
                                (click)="cancelEditCancha()">Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>